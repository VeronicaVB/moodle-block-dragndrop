{"version":3,"sources":["../src/control.js"],"names":["define","init","filelist","document","getElementById","links","getElementsByTagName","Array","from","forEach","element","index","array","traversechildren","children","addEventListener","evt","dataTransfer","setData","getAttribute","effectAllowed","myfile","path","sessionStorage","setItem","JSON","stringify","console","log","parse","getItem","alert","URL"],"mappings":"AA0BAA,OAAM,2BAAC,CAAC,QAAD,CAAD,CAAa,UAAa,CAmD5B,MAAO,CACHC,IAAI,CAlDR,UAA0B,IAClBC,CAAAA,CAAQ,CAAGC,QAAQ,CAACC,cAAT,CAAwB,cAAxB,CADO,CAElBC,CAAK,CAAGH,CAAQ,CAACI,oBAAT,CAA8B,IAA9B,CAFU,CAItBC,KAAK,CAACC,IAAN,CAAWH,CAAX,EAAkBI,OAAlB,CACQ,SAAUC,CAAV,CAAmBC,CAAnB,CAA0BC,CAA1B,CAAiC,CAC7BC,CAAgB,CAACD,CAAK,CAACD,CAAD,CAAL,CAAaG,QAAd,CACnB,CAHT,EAOA,QAASD,CAAAA,CAAT,CAA0BC,CAA1B,CAAoC,CAChCP,KAAK,CAACC,IAAN,CAAWM,CAAX,EAAqBL,OAArB,CACQ,SAAUC,CAAV,CAAmBC,CAAnB,CAA0BC,CAA1B,CAAiC,CAC7BA,CAAK,CAACD,CAAD,CAAL,CAAaI,gBAAb,CAA8B,WAA9B,CAA2C,SAAUC,CAAV,CAAe,CAEtD,GAAyB,IAArB,GAAAA,CAAG,CAACC,YAAR,CAA+B,CAC3BD,CAAG,CAACC,YAAJ,CAAiBC,OAAjB,CAAyB,aAAzB,CAAwCN,CAAK,CAACD,CAAD,CAAL,CAAaQ,YAAb,CAA0B,mBAA1B,CAAxC,EAGAH,CAAG,CAACC,YAAJ,CAAiBG,aAAjB,CAAiC,MAAjC,CAEA,GAAIC,CAAAA,CAAM,CAAG,CACTC,IAAI,CAAEV,CAAK,CAACD,CAAD,CAAL,CAAaQ,YAAb,CAA0B,UAA1B,CADG,CAAb,CAGAI,cAAc,CAACC,OAAf,CAAuBb,CAAvB,CAA8Bc,IAAI,CAACC,SAAL,CAAeL,CAAf,CAA9B,CACH,CAEJ,CAdD,KAgBAT,CAAK,CAACD,CAAD,CAAL,CAAaI,gBAAb,CAA8B,WAA9B,CAA2C,UAAe,CACtDY,OAAO,CAACC,GAAR,CAAY,mBAAZ,EACAD,OAAO,CAACC,GAAR,CAAYH,IAAI,CAACI,KAAL,CAAWN,cAAc,CAACO,OAAf,CAAuBnB,CAAvB,CAAX,CAAZ,CAEH,CAJD,KAMAC,CAAK,CAACD,CAAD,CAAL,CAAaI,gBAAb,CAA8B,SAA9B,CAAyC,SAAUC,CAAV,CAAe,CACpDW,OAAO,CAACC,GAAR,CAAY,kBAAZ,EACAZ,CAAG,CAACC,YAAJ,CAAiBC,OAAjB,CAAyB,aAAzB,CAAwCN,CAAK,CAACD,CAAD,CAAL,CAAaQ,YAAb,CAA0B,mBAA1B,CAAxC,EACDY,KAAK,CAACnB,CAAK,CAACD,CAAD,CAAL,CAAaQ,YAAb,CAA0B,UAA1B,CAAD,CAAL,CACA,GAAIa,CAAAA,GAAJ,CAAQpB,CAAK,CAACD,CAAD,CAAL,CAAaQ,YAAb,CAA0B,UAA1B,CAAR,CAGF,CAPD,IAQH,CAhCT,CAiCH,CAEJ,CAEM,CAGV,CAtDK,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Provides the block_dragndrop/control module\n *\n * @package   block_dragndrop\n * @category  output\n * @copyright 2020 Veronica Bermegui\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n/**\n * @module block_dragndrop/control\n */\ndefine(['jquery'], function ($) {\n\n    function init(instanceid) {\n        var filelist = document.getElementById(\"dndlistfiles\");\n        var links = filelist.getElementsByTagName(\"li\");\n\n        Array.from(links).forEach(\n                function (element, index, array) {\n                    traversechildren(array[index].children);\n                }\n        );\n\n        //Works in Chrome\n        function traversechildren(children) {\n            Array.from(children).forEach(\n                    function (element, index, array) {\n                        array[index].addEventListener(\"dragstart\", function (evt) {\n\n                            if (evt.dataTransfer !== null) {\n                                evt.dataTransfer.setData(\"DownloadURL\", array[index].getAttribute(\"data-download-url\"));\n                                //var mtype = (array[index].getAttribute(\"data-download-url\")).split(\":\")[0];\n                                //evt.dataTransfer.setData(mtype,array[index].getAttribute(\"data-download-url\"));\n                                evt.dataTransfer.effectAllowed = \"move\";\n\n                                let myfile = {\n                                    path: array[index].getAttribute(\"data-url\")\n                                };\n                                sessionStorage.setItem(index, JSON.stringify(myfile));\n                            }\n\n                        }, false);\n\n                        array[index].addEventListener(\"dragenter\", function (evt) {\n                            console.log('Entro en Dropzone');\n                            console.log(JSON.parse(sessionStorage.getItem(index)));\n                            //console.log(evt.dataTransfer.files);                          \n                        }, false);\n\n                        array[index].addEventListener(\"dragend\", function (evt) {\n                            console.log('Entro en dragend');\n                            evt.dataTransfer.setData(\"DownloadURL\", array[index].getAttribute(\"data-download-url\"));\n                           alert(array[index].getAttribute(\"data-url\"));\n                           new URL(array[index].getAttribute(\"data-url\"));\n                            \n\n                        }, false);\n                    });\n        }\n\n    }\n\n    return {\n        init: init\n    };\n});"],"file":"control.min.js"}